select 
	(select first_name from player
	 	where id = '456') as pls1,
	first_name,
	count(case
		when player2_id = '456' then player1_id else player2_id
	end) as other_player_id
from Daily_interactions
join player
on player.id in (player1_id, player2_id)
where player1_id = '456' or player2_id = '456' and status = 'alive'
group by status, first_name, last_name
order by count(*) desc
limit 1

CHAT WANTED:




SELECT 
    p1.first_name AS player_456_name,
    p2.first_name AS companion_name,
    COUNT(*) AS interaction_count
FROM Daily_interactions d
JOIN player p1 ON p1.id = 456
JOIN player p2 ON (
    (d.player1_id = 456 AND d.player2_id = p2.id) OR 
    (d.player2_id = 456 AND d.player1_id = p2.id)
)
WHERE p2.status = 'alive'
GROUP BY p1.first_name, p2.first_name
ORDER BY interaction_count DESC
LIMIT 1;
